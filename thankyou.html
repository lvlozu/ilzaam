<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>✅ Booking Confirmed</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Default to JPG so there’s never a white screen;
       once BG.gif loads, we switch to it via body.gif-bg */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: url('BG.jpg') center/cover no-repeat;
      z-index: -1;
    }
    body.gif-bg::before {
      background-image: url('BG.gif?v=2'); /* cache-buster in case of stale cache */
    }

    /* Removed blur/opacity layer entirely */
    .copy-btn {
      cursor: pointer;
      background-color: #e0e7ff;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 0.875rem;
    }
  </style>
</head>
<body class="p-6 text-gray-800">
  <div class="max-w-xl mx-auto shadow p-6 rounded bg-white/80">
    <h1 class="text-2xl font-bold text-green-600 mb-4 text-center">🎉 Booking Successful</h1>
    
    <div class="mb-4">
      <p class="font-medium">👤 Booked By: <span id="fullName"></span></p>
      <p class="font-medium">📞 Contact: <span id="phone"></span></p>
    </div>

    <div id="bookingDetails" class="mb-4 bg-gray-100 p-4 rounded text-sm"></div>

    <div class="mb-4">
      <p class="font-semibold">💰 Ticket Price: 150 MVR</p>
      <p class="font-semibold">🎫 Total Tickets: <span id="totalTickets"></span></p>
      <p class="font-semibold">💵 Total Amount: <span id="totalAmount"></span> MVR</p>
    </div>

    <div class="mb-4">
      <p class="mb-1">📤 Please transfer the amount to:</p>
      <div class="flex items-center space-x-2">
        <span class="font-mono">7730000654882 – BIZOLVE</span>
        <button class="copy-btn" onclick="copyAccount()">📋 Copy</button>
      </div>
      <p class="mt-1 text-sm text-gray-700">📞 Viber to 7981238 (irfan)</p>
    </div>

    <p class="text-sm text-red-600 mb-2">
      ⚠️ Your booking will only be confirmed after payment is sent and verified. 
      Please complete the payment within <b>60 minutes</b> of booking.
    </p>

    <p class="text-sm mt-4 text-blue-700">
      📸 Please take a screenshot of this page for your reference.
    </p>

    <!-- Bottom Thank You Section -->
    <div class="mt-8 text-center">
      <h2 class="text-2xl font-bold text-green-700 leading-tight">Thank You</h2>
      <h3 class="text-xl font-semibold text-green-600 mb-4">See You at The Movie</h3>
    </div>

    <div class="text-left text-gray-900 mb-6">
      <p class="font-medium">🎥 Kanbulo - The Movie</p>
      <p>📅 12th September 2025 (Friday Night)</p>
      <p>📍 Miladhoo Youth Center</p>
    </div>

    <div class="text-center">
      <!-- skip landing/trailer on rebook -->
      <a href="index.html#book" class="bg-blue-600 text-white px-4 py-2 rounded inline-block">
        🎫 Book Another Ticket
      </a>
    </div>
  </div>

  <script>
    // Progressive background: swap to GIF only after it loads (prevents blank/white)
    (function(){
      const img = new Image();
      img.onload = () => document.body.classList.add('gif-bg');
      img.onerror = () => console.warn('BG.gif failed to load (check path/case). Using BG.jpg fallback.');
      img.src = 'BG.gif?v=2';
    })();

    const fullName = localStorage.getItem("bookingFullName") || "N/A";
    const phone = localStorage.getItem("bookingPhone") || "N/A";
    const selectedSeats = JSON.parse(localStorage.getItem("selectedSeats")) || [];

    document.getElementById("fullName").textContent = fullName;
    document.getElementById("phone").textContent = phone;
    document.getElementById("totalTickets").textContent = selectedSeats.length;
    document.getElementById("totalAmount").textContent = selectedSeats.length * 150;

    document.getElementById("bookingDetails").innerHTML = selectedSeats.map(s => {
      const screenName = s.seatId
        .replace('screenA', 'Screen A')
        .replace('screenB', 'Screen B')
        .replace('screenC', 'Screen C');
      return `<div>🎫 ${screenName} – ${s.name}</div>`;
    }).join("");

    function copyAccount() {
      navigator.clipboard.writeText("7730000654882").then(() => {
        alert("Account number copied!");
      }).catch(() => alert("Unable to copy. Try manually."));
    }
  </script>
</body>
</html>
